Tue, 27 Sep 2016 12:20:47 +0400
	New upstream release
	Version 0.4

 - refactored for unification client and server code:
   * as a service used kurenmad file that contains the common code to initialize
     and run regardless of role. The specific code for each of the roles is
     loaded dynamically from files client.kurenma.src or server.kurenma.src
   * used unified single config file kurenma.ini for client and server with
     'role' option as selector. Added config example kurenma.ini.example that
     included  all options for client and server roles
 - added new file 'kurenmactl' as service management tool:
   * improved Systemd support, used forking type for unit
   * added SystemV init support
   * used special control file for gracefully service ending
 - used 'portAuth' option as port for key exchange
 - udfCheckNetcat replaced by udfStopProcess from bashlyk version 1.86 - the
   most versatile way to stop the process
 - updated lists of external commands and important options and variables
 - used udfLocalVarFromCsv from bashlyk 1.86 for binding options and variables
 - used udfGetValidIPsOnly and udfGetValidCIDR from bashlyk 1.86 for IP and CIDR
   manipulation

kurenmad:
 - added function udfWatchdog for waiting with stop command checking, used
   instead sleep, return iErrorAbortedBySignal on stop signal
 - show role on start service

server.kurenma.src:
 - udfMakeFifo removed, used udfMakeTemp .. type=pipe .. from bashlyk
 - redirection used instead 'cat' command
 - ipsAllowed option parsed by using udfGetValidCIDR from bashlyk 1.86
 - refactored, added functions udfShowPeerInfo and udfSetupTunnel
 - fixed udfSelfCheck - arguments not used, checked external variables fnCtl and
   portAuth

client.kurenma.src:
 - bDaemonize option removed, client started as service only
 - no reexec required for reconnection with server
 - knock used after availibility checking
 - improved logging, code splittes to small blocks, added new functions:
   * udfKnocking - check server availibity
   * udfGetTunnelSettings - try bind keys with server
   * udfSetupTunnel - use getted settings for tunnel activating
   * udfSetDefaultRoute - set default route if needed
   * udfShowPeerInfo - show created peer info if needed
 - added new Error state - NotAvailable

kurenmactl:
 - used nohup and /dev/null redirection for daemonize
 - return success if process already not exists
 - used flag _bashlyk_log=nouse for disable autologging, feature bashlyk 1.86
 - improved service control, added control shot for service after 8 sec
 - portAuth value getted from kurenma.ini for netcat checking

kurenma.ini.example:
 - bDaemonize option removed
 - added 'portAuth' option

setup-knockd:
 - removed temporary fixes for udfChangeIni by using bashlyk version 1.86

Makefile.am:
 - added setup-knockd for install
 - used enable/disable option of systemctl for service install/uninstall
 - SystemV init script 'kurenma' renamed to 'kurenma.disabled' if systemd
   supported

Fri, 02 Sep 2016 00:37:23 +0400
	New upstream release
	Version 0.3

 - support systemd for service starting, added file kurenma.service - systemd
   unit for service, used 'simple' mode for daemonize
 - update-firehol script used locking for client requests
 - added script setup-knockd for knock sequence generating from file of server
   certificate. This sequence placed in section 'kurenma' of knockd.conf
 - added function udfGetTimeInSec that supports plural - "2hours" and etc. for
   resolve human readable format of options and return number of seconds
 - adopted server and client for use bashlyk 1.85 - 'udfOnError2' instead
   udfOnError, 'udfDebug' with stderr support
 - used pseudo 'try - catch' block 'try-every-line' - 'catch-every-line' from
   bashlyk 1.85 for simplify control the flow of external commands:
   * showed a dot for each successful execution of the command-line from a flow
   * display the line number, code, output and the call stack for a non-zero
     status of the command from catching flow
 - updated WireGuard 'persistent-keepalive' handling - default value of
   'persistent-keepalive' now is 0, i.e off, persistent-keepalive disabled on
   default server and client configurations. Option 'keepalive' renamed to
   'tsKeepalive' and limited to 65355 seconds
 - udfGetValidIPsOnly return false for empty result
 - added option tsPeerTimeout for close inactive peers
 - send warnings to stderr if it's needed
 - gen-ssl-kurenma - fixed variable init typos
 - fixed printf using for safety

 kurenmas:
 - improved mime data sending to openssl
 - fixed handling input for netcat, udfWaitRequest updated:
   * loop of input reading not stopped on any events
   * input buffer cleared on starting of SSL message, after handling of SSL
     message or overflow of input data
 - netcat used option -k ( not exit on connection close)
 - udfCheckNetcat - try kill -15 and -9, if necessary
 - after stopping the netcat checks for the "stop" command in PID file
 - check first argument as control command for service :
   * start - normal start to endless loop around netcat
   * stop - send "stop" command via PID file, kill netcat and exit
 - use global variable _kurenmas_ctl for daemonize with systemd
 - if latest-handshake of peer equal 0 then peer do not removed
 - used {try,catch}-every-line block for tunnel init
 - udfMakeFifo - make pipe in /var/run/kurenma
 - added function udfUsage - show usage

 kurenmac:
 - improved the process of connecting, —Åhecking the availability of the remote
   port and key exchange process is repeated until a successful attempt
 - added support for options bDaemonize, bDefaultRoute, tsPeerTimeout and
   tsKeepalive from client.kurenma.ini:
   * tsPeerTimeout - max time without handshake, used human readable format
   * bDaemonize for set/unset idle mode for kurenmac
   * bDefaultRoute for set default route via WireGuard tunnel
   * tsKeepalive for persistent-keepalive options of WireGuard
 - restarts connection if there are no a handshake with the server during the
   time "tsPeerTimeout" in idle mode

 update-firehol:
 - added locking (flock) with special lock file, used timeout based locking for
   inclusion client IP to firehol "white" list. Locking activated by reexec with
   exported global variable
 - get current wireguard endpoints list for preserve active peers connections
 - added stat file with records of last client knocking. The contents of this
   file are used for additional protection against collisions of client requests
 - used systemctl to start kurenmas service
 - safety clean temp files before reexec

 Makefile.am:
 - used install-data-hook for service
 - supress error from install-data-hook
 - client/server ini renamed as example
 - added kurenma.service for installation

Wed, 03 Aug 2016 10:50:04 +0400
	New upstream release
	Version 0.2
 - binded peer properties to 'Common Name' of the peer certificate
 - prevented running multiple instances of the peers
 - enabled run instances of the peers only from root
 - server side runned as service by endless loop around of netcat:
   * stdin and stdout of netcat looped through a named pipe
   * added function udfWaitRequest to control the netcat
   * used PKCS7 format for initial key exchange
   * input stream more than 64 lines discarded
   * added function udfHandleRequest for WireGuard tunnel creation
   * used stderr for logging, applies 1-5 levels of messages
   * added new function udfSelfCheck for cleaning unexpected long connection
     with the client
   * server gives first free IP for client (option 'dynamic' - default), or
     finds IP by using the 'Common Name' of the client as FQDN ('commonname')
   * client gets previously leased IP (if it is available) after reconnection in
     the 'dynamic' mode. This address temporary binded to the client certificate
   * added handling of section 'ipsAllowed' for getting list of allowed hosts
     and networks
   * added cleaning WireGuard peers with empty allowed-ips
 - added new configuration dn.kurenma.ini to determine the Distinguished Name of
   the Center of Authority (CA) and defaults values for client and server certs
   generation.
 - used single script gen-ssl-kurenma for keys and certs generation:
   * ca                - make CA files and infrastructure
   * crt <Common Name> - make key and certificate files for client or server
 - openssl configurations saved to ../ssl/configs, CSR files saved to ../ssl/csr
 - used knock to start peers handshaking from client
 - added function udfGetValidIPsOnly for IP validating
 - added support for wireguard option 'persistent-keepalive' by using ini config
   option 'keepalive'

Sun, 10 Jul 2016 17:47:51 +0400
	Initial release
	Version 0.1

